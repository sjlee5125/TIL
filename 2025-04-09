# R ê¸°ì´ˆ ë°ì´í„° ë¶„ì„ ë° í•¨ìˆ˜ í™œìš© ì •ë¦¬
# ğŸ“ ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì • ë° í™˜ê²½ ì´ˆê¸°í™”
setwd("C:/r_workdata")  # ì›í•˜ëŠ” í´ë” ê²½ë¡œ ì„¤ì •
Sys.setlocale("LC_ALL", "")  # ë¡œì¼€ì¼ ì„¤ì •
# ğŸ“¦ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸°
library(lubridate)
library(dplyr)
library(ggplot2)
# ğŸ”§ ìì£¼ ì‚¬ìš©ë˜ëŠ” ê¸°ë³¸ í•¨ìˆ˜ ì •ë¦¬
# aggregate(): ë‹¤ì–‘í•œ í•¨ìˆ˜ë¥¼ ì ìš©í•´ ìš”ì•½ ê³„ì‚°
# apply(): í–‰/ì—´ ë‹¨ìœ„ë¡œ í•¨ìˆ˜ ì ìš©
# cor(): ìƒê´€ê³„ìˆ˜ ê³„ì‚°
# cumsum(): ëˆ„ì í•©
# cumprod(): ëˆ„ì ê³±
# diff(): ì°¨ì´ ê³„ì‚°
# length(): ìš”ì†Œ ê°œìˆ˜
# max(): ìµœëŒ€ê°’
# min(): ìµœì†Œê°’
# mean(): í‰ê· 
# median(): ì¤‘ì•™ê°’
# order(): ì •ë ¬ ìˆœì„œ ë°˜í™˜
# prod(): ê³± ê³„ì‚°
# range(): ë²”ìœ„ ë°˜í™˜
# rank(): ìˆœìœ„ ë°˜í™˜
# sd(): í‘œì¤€í¸ì°¨
# rev(): ì—­ìˆœ ì •ë ¬
# sort(): ì •ë ¬
# summary(): ìš”ì•½ í†µê³„
# sweep(): í–‰/ì—´ ë‹¨ìœ„ ì¼ê´„ ì—°ì‚°
# tapply(): ë²¡í„°ì— ê·¸ë£¹ë³„ í•¨ìˆ˜ ì ìš©
# var(): ë¶„ì‚° ê³„ì‚°
# ğŸ“Š ê¸°ë³¸ ë²¡í„° ì—°ì‚°
v1 = c(1,2,3,4,5)
v2 = c('a','b','c','d','e')
max(v1)
max(v2)
mean(v1)
# mean(v2) # ë¬¸ìì— ëŒ€í•´ í‰ê·  ë¶ˆê°€
sd(v1)
sum(v1)
var(v1)

# ğŸŒ googleVis ì‚¬ìš© ì˜ˆì‹œ
install.packages("googleVis")
library(googleVis)
Fruits

# aggregate() ì‚¬ìš© ì˜ˆì‹œ
aggregate(Sales ~ Fruit, Fruits, max)
aggregate(Sales ~ Fruit + Year, Fruits, max)

# apply() ì‚¬ìš© ì˜ˆì‹œ
m1 = matrix(c(1,2,3,4,5,6), 2, byrow=TRUE)
apply(m1, 1, sum)
apply(m1, 2, sum)
apply(m1[, c(2,3)], 2, max)

# ë¦¬ìŠ¤íŠ¸ ì—°ì‚°
l1 = list(Fruits$Sales)
l2 = list(Fruits$Profit)
lapply(c(l1, l2), max)  # ë¦¬ìŠ¤íŠ¸í˜• ë°˜í™˜
sapply(c(l1, l2), max)  # ë²¡í„°í˜• ë°˜í™˜
lapply(Fruits[, c(4,5)], max)
sapply(Fruits[, c(4,5)], max)

# tapply() ì‚¬ìš© ì˜ˆì‹œ
tapply(Sales, Fruit, sum)
tapply(Fruits$Sales, Fruits$Fruit, sum)
attach(Fruits)
tapply(Sales, Fruit, sum)

# mapply() ì‚¬ìš© ì˜ˆì‹œ
v1 = c(1,2,3,4,5)
v2 = c(10,20,30,40,50)
v3 = c(100,200,300,400,500)
mapply(sum, v1, v2, v3)

# CSV íŒŒì¼ ì½ê¸°
d1 <- read.csv("data1.csv", fileEncoding = "cp949")
View(d1)
apply(d1[, c(2:15)], 2, sum)
apply(d1[, c(2:15)], 1, sum)

# ì‚¬ìš©ì ì •ì˜ í•¨ìˆ˜ ì˜ˆì‹œ
my1 = function() {
  return(10)
}
my1()

my2 = function(a) {
  return(a^2)
}
my2(3)

my3 = function(a, b) {
  return(abs(a - b))
}
my3(2, 3)

my4 = function(a, b) {
  if (a > b) {
    c = a - b
  } else {
    c = b - a
  }
  return(c)
}
my4(2, 3)

# ì •ë ¬
s1 = Fruits$Sales
sort(s1)
sort(s1, decreasing = TRUE)

# plyr íŒ¨í‚¤ì§€
install.packages("plyr")
library(plyr)
f = read.csv("fruits_10.csv")

# ddply() ê·¸ë£¹ ìš”ì•½
ddply(f, 'name', summarise, sum_qty = sum(qty), sum_price = sum(price))
ddply(f, 'name', summarise, max_qty = max(qty), min_price = min(price))
ddply(f, c('year', 'name'), summarise, max_qty = max(qty), min_price = min(price))

# transform ì˜ˆì‹œ
ddply(f, 'name', transform, sum_qty = sum(qty), pct_qty = round(qty * 100 / sum(qty), 2))
